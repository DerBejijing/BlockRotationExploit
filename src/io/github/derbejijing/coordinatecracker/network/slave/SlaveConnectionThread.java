package io.github.derbejijing.coordinatecracker.network.slave;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.net.Socket;

/**
 * 
 * The code seen below is UNTESTET
 * and was just uploaded because I work on this from multiple places on multiple devices and need a place to store my "progress"
 * 
 */
public class SlaveConnectionThread extends Thread {

	private String host;
	private int port;
	
	private PrintWriter outputWriter;
	private BufferedReader inputReader;
	
	private boolean running;
	
	private Socket clientSocket;
	
	
	public SlaveConnectionThread(String host, int port) {
		
		this.host = host;
		this.port = port;
		
	}
	
	
	public void killThread() {
		if(this.running) {
			try {
				this.clientSocket.close();
				this.outputWriter.close();
				this.inputReader.close();
			} catch(Exception e) {
				
			}
		}
	}
	
	
	private void startConversation() {
		try {
			clientSocket = new Socket(this.host, this.port);
			outputWriter = new PrintWriter(clientSocket.getOutputStream());
			inputReader = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
			
			
			System.out.println(sendText("Hi there."));
			
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	
	
	private String sendText(String text) throws IOException {
		this.outputWriter.println(text);
		String response = this.inputReader.readLine();
		return response;
	}
	
	
	public void run() {
		running = true;
		
		this.startConversation();
		
		this.killThread();
	}
}
