package io.github.derbejijing.coordinatecracker.network.master;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;

/**
 * 
 * The code seen below is UNTESTET
 * and was just uploaded because I work on this from multiple places on multiple devices and need a place to store my "progress"
 * 
 */
/**
 * 
 * This represents a slave connection.
 * Multiple instances of these will be stored in the ControlNode
 *
 */
public class SlaveConnection extends Thread {

	private final Socket clientSocket;
	private final ControlNode masterInstance;
	
	private PrintWriter outputWriter;
	private BufferedReader inputReader;
	
	private boolean running;
	
	public SlaveConnection(Socket clientSocket, ControlNode masterInstance) {
		
		this.clientSocket = clientSocket;
		this.masterInstance = masterInstance;
		
	}
	
	
	public String getHost() {
		return this.clientSocket.getInetAddress().toString();
	}
	
	
	public void killThread() {
		this.running = false;
		try {
			this.clientSocket.close();
		} catch(Exception e) {
			e.printStackTrace();
		}
	}
	
	
	public void run() {
		this.running = true;
		
		try {
			outputWriter = new PrintWriter(this.clientSocket.getOutputStream(), true);
			inputReader = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
			
			while(this.running) {
				
				String clientMsg = inputReader.readLine();
				outputWriter.println("Hey there. You sent: " + clientMsg);
				
			}
		} catch (IOException e) {
			e.printStackTrace();
			this.killThread();
		}
		
		/***
		 * 
		 * Constantly sends a (set of) chunk(s) to the client
		 * Listens to matches within the chunk
		 * 
		 */
		
	}
	
	
}
